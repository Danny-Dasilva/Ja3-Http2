package main

import (
	"log"

	"./ja3"
)

func main() {
	testPayload := []byte{22, 3, 1, 0, 201, 1, 0, 0, 197, 3, 3, 82, 50, 235, 232, 231, 181, 243, 122, 13, 113, 213, 238, 184, 242, 230, 164, 189, 148, 5, 55, 17, 170, 189, 193, 212, 189, 211, 11, 239, 192, 39, 240, 0, 0, 36, 192, 48, 192, 44, 192, 47, 192, 43, 192, 20, 192, 10, 192, 19, 192, 9, 0, 159, 0, 158, 0, 57, 0, 51, 0, 157, 0, 156, 0, 53, 0, 47, 0, 10, 0, 255, 1, 0, 0, 120, 0, 0, 0, 18, 0, 16, 0, 0, 13, 119, 119, 119, 46, 103, 111, 111, 103, 108, 101, 46, 99, 104, 0, 11, 0, 4, 3, 0, 1, 2, 0, 10, 0, 28, 0, 26, 0, 23, 0, 25, 0, 28, 0, 27, 0, 24, 0, 26, 0, 22, 0, 14, 0, 13, 0, 11, 0, 12, 0, 9, 0, 10, 0, 35, 0, 0, 0, 13, 0, 32, 0, 30, 6, 1, 6, 2, 6, 3, 5, 1, 5, 2, 5, 3, 4, 1, 4, 2, 4, 3, 3, 1, 3, 2, 3, 3, 2, 1, 2, 2, 2, 3, 0, 5, 0, 5, 1, 0, 0, 0, 0, 0, 15, 0, 1, 1, 51, 116, 0, 0}

	ja3, err := ja3.ComputeJA3FromSegment(testPayload)
	if err != nil {
		log.Println("Expected: %v but got: %v\n",  err)
	}
	log.Println(ja3.GetJA3String())
	log.Println(ja3.GetJA3Hash())
	log.Println(ja3.GetSNI())
}